{"version":3,"file":"user.js","sources":["pages/user/user.vue","D:/yx01/UiApp/HBuilderX/plugins/uniapp-cli-vite/uniPage:/cGFnZXMvdXNlci91c2VyLnZ1ZQ"],"sourcesContent":["<template>\r\n  <view class=\"user-container\">\r\n    <!-- 用户信息卡片 -->\r\n    <view class=\"user-card\">\r\n      <view class=\"user-info\">\r\n        <image class=\"avatar\" src=\"/static/avatar.png\" mode=\"aspectFill\"></image>\r\n        <view class=\"info-content\">\r\n          <text class=\"username\">{{userInfo.name}}</text>\r\n          <text class=\"dept\">{{userInfo.deptName}}</text>\r\n        </view>\r\n      </view>\r\n      <view class=\"account-info\">\r\n        <text class=\"phone\">{{formatPhone(userInfo.phone)}}</text>\r\n        <text class=\"role-tag\">{{userInfo.roleName}}</text>\r\n      </view>\r\n    </view>\r\n\r\n    <!-- 功能列表 -->\r\n    <view class=\"menu-list\">\r\n      <!-- 账户安全 -->\r\n      <view class=\"menu-group\">\r\n        <view class=\"group-title\">账户安全</view>\r\n        <view class=\"menu-item\" @tap=\"changePassword\">\r\n          <text class=\"item-name\">修改密码</text>\r\n          <text class=\"arrow\">></text>\r\n        </view>\r\n      </view>\r\n\r\n      <!-- 操作记录 -->\r\n      <view class=\"menu-group\">\r\n        <view class=\"group-title\">操作记录</view>\r\n        <view class=\"menu-item\" @tap=\"navigateTo('records')\">\r\n          <text class=\"item-name\">提交记录</text>\r\n          <text class=\"count-tag\">{{recordCount}}</text>\r\n          <text class=\"arrow\">></text>\r\n        </view>\r\n        <view class=\"menu-item\" @tap=\"navigateTo('approvals')\">\r\n          <text class=\"item-name\">审批历史</text>\r\n          <text class=\"arrow\">></text>\r\n        </view>\r\n      </view>\r\n\r\n      <!-- 系统设置 -->\r\n      <view class=\"menu-group\">\r\n        <view class=\"group-title\">系统设置</view>\r\n        <view class=\"menu-item\">\r\n          <text class=\"item-name\">通知设置</text>\r\n          <switch \r\n            :checked=\"notificationEnabled\"\r\n            @change=\"toggleNotification\"\r\n          />\r\n        </view>\r\n        <view class=\"menu-item\" @tap=\"clearCache\">\r\n          <text class=\"item-name\">清除缓存</text>\r\n          <text class=\"cache-size\">{{cacheSize}}</text>\r\n          <text class=\"arrow\">></text>\r\n        </view>\r\n      </view>\r\n    </view>\r\n\r\n    <!-- 退出登录 -->\r\n    <button class=\"logout-btn\" @tap=\"handleLogout\">退出登录</button>\r\n\r\n    <!-- 修改密码弹窗 -->\r\n    <view class=\"password-modal\" v-if=\"showPasswordModal\">\r\n      <view class=\"modal-content\">\r\n        <view class=\"modal-header\">\r\n          <text class=\"modal-title\">修改密码</text>\r\n          <text class=\"close-btn\" @tap=\"closePasswordModal\">×</text>\r\n        </view>\r\n        <view class=\"form-item\">\r\n          <text class=\"label\">验证码</text>\r\n          <view class=\"verify-input\">\r\n            <input \r\n              type=\"number\"\r\n              maxlength=\"6\"\r\n              v-model=\"verifyCode\"\r\n              placeholder=\"请输入验证码\"\r\n            />\r\n            <button \r\n              class=\"verify-btn\"\r\n              :disabled=\"counting\"\r\n              @tap=\"sendVerifyCode\"\r\n            >{{counting ? `${countdown}s` : '获取验证码'}}</button>\r\n          </view>\r\n        </view>\r\n        <view class=\"form-item\">\r\n          <text class=\"label\">新密码</text>\r\n          <input \r\n            type=\"password\"\r\n            v-model=\"newPassword\"\r\n            placeholder=\"请输入新密码\"\r\n          />\r\n        </view>\r\n        <view class=\"form-item\">\r\n          <text class=\"label\">确认密码</text>\r\n          <input \r\n            type=\"password\"\r\n            v-model=\"confirmPassword\"\r\n            placeholder=\"请再次输入新密码\"\r\n          />\r\n        </view>\r\n        <button \r\n          class=\"submit-btn\"\r\n          :disabled=\"!isPasswordValid\"\r\n          @tap=\"submitPassword\"\r\n        >确认修改</button>\r\n      </view>\r\n    </view>\r\n\r\n    <!-- Toast提示 -->\r\n    <pd-toast ref=\"toast\" />\r\n  </view>\r\n</template>\r\n\r\n<script>\r\nimport PdToast from '@/components/pd-toast/pd-toast'\r\n\r\nexport default {\r\n  components: {\r\n    PdToast\r\n  },\r\n\r\n  data() {\r\n    return {\r\n      // 用户信息\r\n      userInfo: {\r\n        name: '张三',\r\n        phone: '13800138000',\r\n        deptName: '磨房',\r\n        roleName: '生产部门'\r\n      },\r\n\r\n      // 统计数据\r\n      recordCount: 0,\r\n      cacheSize: '0MB',\r\n\r\n      // 设置状态\r\n      notificationEnabled: true,\r\n\r\n      // 修改密码\r\n      showPasswordModal: false,\r\n      verifyCode: '',\r\n      newPassword: '',\r\n      confirmPassword: '',\r\n      counting: false,\r\n      countdown: 60\r\n    }\r\n  },\r\n\r\n  computed: {\r\n    isPasswordValid() {\r\n      return this.verifyCode.length === 6 &&\r\n             this.newPassword.length >= 6 &&\r\n             this.newPassword === this.confirmPassword\r\n    }\r\n  },\r\n\r\n  methods: {\r\n    // 格式化手机号\r\n    formatPhone(phone) {\r\n      return phone.replace(/(\\d{3})\\d{4}(\\d{4})/, '$1****$2')\r\n    },\r\n\r\n    // 发送验证码\r\n    async sendVerifyCode() {\r\n      if(this.counting) return\r\n      \r\n      try {\r\n        // TODO: 调用发送验证码API\r\n        await new Promise(resolve => setTimeout(resolve, 500))\r\n        \r\n        this.counting = true\r\n        this.countdown = 60\r\n        \r\n        const timer = setInterval(() => {\r\n          this.countdown--\r\n          if(this.countdown <= 0) {\r\n            clearInterval(timer)\r\n            this.counting = false\r\n          }\r\n        }, 1000)\r\n        \r\n        this.$refs.toast.show({\r\n          type: 'success',\r\n          message: '验证码已发送'\r\n        })\r\n      } catch(e) {\r\n        this.$refs.toast.show({\r\n          type: 'error',\r\n          message: '发送失败'\r\n        })\r\n      }\r\n    },\r\n\r\n    // 提交新密码\r\n    async submitPassword() {\r\n      if(!this.isPasswordValid) return\r\n      \r\n      try {\r\n        // TODO: 调用修改密码API\r\n        await new Promise(resolve => setTimeout(resolve, 1000))\r\n        \r\n        this.$refs.toast.show({\r\n          type: 'success',\r\n          message: '密码修改成功'\r\n        })\r\n        \r\n        this.closePasswordModal()\r\n      } catch(e) {\r\n        this.$refs.toast.show({\r\n          type: 'error',\r\n          message: '修改失败'\r\n        })\r\n      }\r\n    },\r\n\r\n    // 切换通知状态\r\n    async toggleNotification(e) {\r\n      this.notificationEnabled = e.detail.value\r\n      // TODO: 保存设置\r\n    },\r\n\r\n    // 清除缓存\r\n    async clearCache() {\r\n      try {\r\n        uni.showLoading({ title: '清理中' })\r\n        // TODO: 清除本地缓存\r\n        await new Promise(resolve => setTimeout(resolve, 1000))\r\n        \r\n        this.cacheSize = '0MB'\r\n        this.$refs.toast.show({\r\n          type: 'success',\r\n          message: '清理完成'\r\n        })\r\n      } catch(e) {\r\n        this.$refs.toast.show({\r\n          type: 'error',\r\n          message: '清理失败'\r\n        })\r\n      } finally {\r\n        uni.hideLoading()\r\n      }\r\n    },\r\n\r\n    // 退出登录\r\n    handleLogout() {\r\n      uni.showModal({\r\n        title: '提示',\r\n        content: '确定要退出登录吗？',\r\n        success: (res) => {\r\n          if(res.confirm) {\r\n            // TODO: 清除登录状态\r\n            uni.reLaunch({ url: '/pages/login/login' })\r\n          }\r\n        }\r\n      })\r\n    },\r\n\r\n    // 页面跳转\r\n    navigateTo(page) {\r\n      uni.navigateTo({ url: `/pages/user/${page}` })\r\n    },\r\n\r\n    // 打开修改密码弹窗\r\n    changePassword() {\r\n      this.showPasswordModal = true\r\n    },\r\n\r\n    // 关闭修改密码弹窗\r\n    closePasswordModal() {\r\n      this.showPasswordModal = false\r\n      this.verifyCode = ''\r\n      this.newPassword = ''\r\n      this.confirmPassword = ''\r\n    }\r\n  },\r\n\r\n  onShow() {\r\n    // 获取缓存大小\r\n    uni.getStorageInfo({\r\n      success: (res) => {\r\n        this.cacheSize = (res.currentSize / 1024).toFixed(2) + 'MB'\r\n      }\r\n    })\r\n    \r\n    // 获取记录数量\r\n    this.recordCount = 12 // TODO: 从后端获取\r\n  }\r\n}\r\n</script>\r\n\r\n<style>\r\n.user-container {\r\n  min-height: 100vh;\r\n  background: #f8f8f8;\r\n  padding-bottom: 40rpx;\r\n}\r\n\r\n/* 用户信息卡片 */\r\n.user-card {\r\n  background: #fff;\r\n  padding: 40rpx 30rpx;\r\n  margin-bottom: 20rpx;\r\n}\r\n\r\n.user-info {\r\n  display: flex;\r\n  align-items: center;\r\n  margin-bottom: 20rpx;\r\n}\r\n\r\n.avatar {\r\n  width: 120rpx;\r\n  height: 120rpx;\r\n  border-radius: 50%;\r\n  margin-right: 20rpx;\r\n}\r\n\r\n.info-content {\r\n  flex: 1;\r\n}\r\n\r\n.username {\r\n  font-size: 36rpx;\r\n  color: #333;\r\n  font-weight: bold;\r\n  margin-bottom: 8rpx;\r\n  display: block;\r\n}\r\n\r\n.dept {\r\n  font-size: 28rpx;\r\n  color: #666;\r\n}\r\n\r\n.account-info {\r\n  display: flex;\r\n  align-items: center;\r\n  justify-content: space-between;\r\n}\r\n\r\n.phone {\r\n  font-size: 28rpx;\r\n  color: #999;\r\n}\r\n\r\n.role-tag {\r\n  background: #e6f7ff;\r\n  color: #1890ff;\r\n  font-size: 24rpx;\r\n  padding: 4rpx 12rpx;\r\n  border-radius: 4rpx;\r\n}\r\n\r\n/* 功能列表 */\r\n.menu-list {\r\n  background: #fff;\r\n  margin-bottom: 40rpx;\r\n}\r\n\r\n.menu-group {\r\n  padding: 0 30rpx;\r\n}\r\n\r\n.group-title {\r\n  font-size: 28rpx;\r\n  color: #999;\r\n  padding: 20rpx 0;\r\n}\r\n\r\n.menu-item {\r\n  display: flex;\r\n  align-items: center;\r\n  height: 100rpx;\r\n  border-bottom: 1rpx solid #f0f0f0;\r\n}\r\n\r\n.item-name {\r\n  flex: 1;\r\n  font-size: 32rpx;\r\n  color: #333;\r\n}\r\n\r\n.count-tag {\r\n  background: #ff4d4f;\r\n  color: #fff;\r\n  font-size: 24rpx;\r\n  padding: 4rpx 12rpx;\r\n  border-radius: 20rpx;\r\n  margin-right: 12rpx;\r\n}\r\n\r\n.cache-size {\r\n  font-size: 28rpx;\r\n  color: #999;\r\n  margin-right: 12rpx;\r\n}\r\n\r\n.arrow {\r\n  font-size: 32rpx;\r\n  color: #999;\r\n}\r\n\r\n/* 退出按钮 */\r\n.logout-btn {\r\n  width: 90%;\r\n  height: 90rpx;\r\n  line-height: 90rpx;\r\n  background: #ff4d4f;\r\n  color: #fff;\r\n  font-size: 32rpx;\r\n  border-radius: 45rpx;\r\n  margin: 0 auto;\r\n}\r\n\r\n/* 修改密码弹窗 */\r\n.password-modal {\r\n  position: fixed;\r\n  top: 0;\r\n  left: 0;\r\n  right: 0;\r\n  bottom: 0;\r\n  background: rgba(0,0,0,0.6);\r\n  display: flex;\r\n  align-items: center;\r\n  justify-content: center;\r\n  z-index: 1000;\r\n}\r\n\r\n.modal-content {\r\n  width: 90%;\r\n  background: #fff;\r\n  border-radius: 12rpx;\r\n  padding: 30rpx;\r\n}\r\n\r\n.modal-header {\r\n  display: flex;\r\n  justify-content: space-between;\r\n  align-items: center;\r\n  margin-bottom: 30rpx;\r\n}\r\n\r\n.modal-title {\r\n  font-size: 32rpx;\r\n  color: #333;\r\n  font-weight: bold;\r\n}\r\n\r\n.close-btn {\r\n  font-size: 40rpx;\r\n  color: #999;\r\n  padding: 10rpx;\r\n}\r\n\r\n.form-item {\r\n  margin-bottom: 30rpx;\r\n}\r\n\r\n.label {\r\n  font-size: 28rpx;\r\n  color: #333;\r\n  margin-bottom: 12rpx;\r\n  display: block;\r\n}\r\n\r\n.verify-input {\r\n  display: flex;\r\n  gap: 20rpx;\r\n}\r\n\r\n.verify-input input {\r\n  flex: 1;\r\n  height: 80rpx;\r\n  background: #f8f8f8;\r\n  border-radius: 8rpx;\r\n  padding: 0 20rpx;\r\n  font-size: 28rpx;\r\n}\r\n\r\n.verify-btn {\r\n  width: 200rpx;\r\n  height: 80rpx;\r\n  line-height: 80rpx;\r\n  background: #1890ff;\r\n  color: #fff;\r\n  font-size: 28rpx;\r\n  border-radius: 8rpx;\r\n  margin: 0;\r\n}\r\n\r\n.verify-btn[disabled] {\r\n  opacity: 0.5;\r\n}\r\n\r\n.submit-btn {\r\n  width: 100%;\r\n  height: 80rpx;\r\n  line-height: 80rpx;\r\n  background: #1890ff;\r\n  color: #fff;\r\n  font-size: 32rpx;\r\n  border-radius: 40rpx;\r\n  margin: 0;\r\n}\r\n\r\n.submit-btn[disabled] {\r\n  opacity: 0.5;\r\n}\r\n</style> ","import MiniProgramPage from 'C:/Users/18454/OneDrive/文档/GitHub/pd/pd071/pages/user/user.vue'\nwx.createPage(MiniProgramPage)"],"names":["uni"],"mappings":"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"}