{"version":3,"file":"user-activity-chart.js","sources":["pages/admin/components/user-activity-chart.vue","../../HBuilderX/plugins/uniapp-cli-vite/uniComponent:/RDoveXgwMS9VaUFwcC9wZDA3L3BkMDcxL3BhZ2VzL2FkbWluL2NvbXBvbmVudHMvdXNlci1hY3Rpdml0eS1jaGFydC52dWU"],"sourcesContent":["<template>\r\n  <view class=\"activity-chart\">\r\n    <!-- 角色活跃度饼图 -->\r\n    <view class=\"pie-chart\">\r\n      <view \r\n        class=\"pie-segment\"\r\n        v-for=\"(role, index) in data.roles\"\r\n        :key=\"role.name\"\r\n        :style=\"{\r\n          backgroundColor: colors[index],\r\n          transform: `rotate(${getRotation(index)}deg)`,\r\n          width: `${role.value}%`\r\n        }\"\r\n      ></view>\r\n      <view class=\"pie-center\">\r\n        <text class=\"total-text\">总活跃</text>\r\n        <text class=\"total-value\">{{getTotalValue()}}</text>\r\n      </view>\r\n    </view>\r\n\r\n    <!-- 图例 -->\r\n    <view class=\"chart-legend\">\r\n      <view \r\n        class=\"legend-item\"\r\n        v-for=\"(role, index) in data.roles\"\r\n        :key=\"role.name\"\r\n      >\r\n        <view \r\n          class=\"legend-color\"\r\n          :style=\"{backgroundColor: colors[index]}\"\r\n        ></view>\r\n        <text class=\"legend-text\">{{role.name}}</text>\r\n        <text class=\"legend-value\">{{role.value}}%</text>\r\n      </view>\r\n    </view>\r\n\r\n    <!-- 时段活跃度 -->\r\n    <view class=\"timeline-chart\">\r\n      <view class=\"timeline-header\">\r\n        <text>时段活跃度</text>\r\n        <text class=\"peak-time\">高峰: {{getPeakTime()}}</text>\r\n      </view>\r\n      <view class=\"timeline-bars\">\r\n        <view \r\n          class=\"time-bar\"\r\n          v-for=\"(hour, index) in 24\"\r\n          :key=\"hour\"\r\n          :style=\"{\r\n            height: `${getTimelineHeight(index)}rpx`,\r\n            backgroundColor: getTimelineColor(index)\r\n          }\"\r\n        >\r\n          <text class=\"bar-value\" v-if=\"getTimelineHeight(index) > 60\">\r\n            {{getTimelineValue(index)}}\r\n          </text>\r\n        </view>\r\n      </view>\r\n      <view class=\"timeline-labels\">\r\n        <text \r\n          class=\"time-label\"\r\n          v-for=\"hour in [0,6,12,18,23]\"\r\n          :key=\"hour\"\r\n        >{{hour}}:00</text>\r\n      </view>\r\n    </view>\r\n  </view>\r\n</template>\r\n\r\n<script>\r\nexport default {\r\n  name: 'UserActivityChart',\r\n  props: {\r\n    data: {\r\n      type: Object,\r\n      required: true\r\n    }\r\n  },\r\n  \r\n  data() {\r\n    return {\r\n      colors: ['#1890ff', '#52c41a', '#faad14', '#722ed1']\r\n    }\r\n  },\r\n  \r\n  methods: {\r\n    // 获取饼图旋转角度\r\n    getRotation(index) {\r\n      let rotation = 0\r\n      for(let i = 0; i < index; i++) {\r\n        rotation += this.data.roles[i].value\r\n      }\r\n      return rotation * 3.6 // 将百分比转换为角度\r\n    },\r\n    \r\n    // 获取总活跃度\r\n    getTotalValue() {\r\n      return this.data.roles.reduce((sum, role) => sum + role.value, 0)\r\n    },\r\n    \r\n    // 获取时段柱状图高度\r\n    getTimelineHeight(hour) {\r\n      const value = this.data.timeline?.[hour] || 0\r\n      return Math.max(value * 2, 20) // 最小高度20rpx\r\n    },\r\n    \r\n    // 获取时段柱状图颜色\r\n    getTimelineColor(hour) {\r\n      const value = this.data.timeline?.[hour] || 0\r\n      if(value > 80) return '#ff4d4f'\r\n      if(value > 50) return '#faad14'\r\n      return '#1890ff'\r\n    },\r\n    \r\n    // 获取时段值\r\n    getTimelineValue(hour) {\r\n      return this.data.timeline?.[hour] || 0\r\n    },\r\n    \r\n    // 获取高峰时段\r\n    getPeakTime() {\r\n      if(!this.data.timeline) return '--:--'\r\n      \r\n      let peakHour = 0\r\n      let peakValue = 0\r\n      \r\n      for(let hour = 0; hour < 24; hour++) {\r\n        const value = this.data.timeline[hour] || 0\r\n        if(value > peakValue) {\r\n          peakValue = value\r\n          peakHour = hour\r\n        }\r\n      }\r\n      \r\n      return `${peakHour.toString().padStart(2, '0')}:00`\r\n    }\r\n  }\r\n}\r\n</script>\r\n\r\n<style>\r\n.activity-chart {\r\n  height: 100%;\r\n  display: flex;\r\n  flex-direction: column;\r\n}\r\n\r\n/* 饼图 */\r\n.pie-chart {\r\n  width: 200rpx;\r\n  height: 200rpx;\r\n  border-radius: 50%;\r\n  position: relative;\r\n  margin: 0 auto;\r\n}\r\n\r\n.pie-segment {\r\n  position: absolute;\r\n  top: 0;\r\n  left: 0;\r\n  height: 100%;\r\n  transform-origin: 100% 50%;\r\n}\r\n\r\n.pie-center {\r\n  position: absolute;\r\n  top: 50%;\r\n  left: 50%;\r\n  transform: translate(-50%, -50%);\r\n  width: 120rpx;\r\n  height: 120rpx;\r\n  background: #fff;\r\n  border-radius: 50%;\r\n  display: flex;\r\n  flex-direction: column;\r\n  align-items: center;\r\n  justify-content: center;\r\n}\r\n\r\n.total-text {\r\n  font-size: 20rpx;\r\n  color: #999;\r\n}\r\n\r\n.total-value {\r\n  font-size: 28rpx;\r\n  color: #333;\r\n  font-weight: bold;\r\n}\r\n\r\n/* 图例 */\r\n.chart-legend {\r\n  display: flex;\r\n  flex-wrap: wrap;\r\n  justify-content: center;\r\n  gap: 20rpx;\r\n  margin: 20rpx 0;\r\n}\r\n\r\n.legend-item {\r\n  display: flex;\r\n  align-items: center;\r\n  gap: 8rpx;\r\n}\r\n\r\n.legend-color {\r\n  width: 20rpx;\r\n  height: 20rpx;\r\n  border-radius: 4rpx;\r\n}\r\n\r\n.legend-text {\r\n  font-size: 24rpx;\r\n  color: #666;\r\n}\r\n\r\n.legend-value {\r\n  font-size: 24rpx;\r\n  color: #333;\r\n  font-weight: bold;\r\n}\r\n\r\n/* 时段图表 */\r\n.timeline-chart {\r\n  flex: 1;\r\n  padding: 20rpx 0;\r\n}\r\n\r\n.timeline-header {\r\n  display: flex;\r\n  justify-content: space-between;\r\n  align-items: center;\r\n  margin-bottom: 20rpx;\r\n  padding: 0 20rpx;\r\n}\r\n\r\n.timeline-header text {\r\n  font-size: 24rpx;\r\n  color: #666;\r\n}\r\n\r\n.peak-time {\r\n  color: #ff4d4f;\r\n}\r\n\r\n.timeline-bars {\r\n  height: 200rpx;\r\n  display: flex;\r\n  align-items: flex-end;\r\n  gap: 4rpx;\r\n  padding: 0 20rpx;\r\n}\r\n\r\n.time-bar {\r\n  flex: 1;\r\n  min-height: 20rpx;\r\n  background: #1890ff;\r\n  position: relative;\r\n  transition: height 0.3s;\r\n}\r\n\r\n.bar-value {\r\n  position: absolute;\r\n  top: -30rpx;\r\n  left: 50%;\r\n  transform: translateX(-50%);\r\n  font-size: 20rpx;\r\n  color: #666;\r\n}\r\n\r\n.timeline-labels {\r\n  display: flex;\r\n  justify-content: space-between;\r\n  padding: 10rpx 20rpx 0;\r\n}\r\n\r\n.time-label {\r\n  font-size: 20rpx;\r\n  color: #999;\r\n}\r\n</style> ","import Component from 'D:/yx01/UiApp/pd07/pd071/pages/admin/components/user-activity-chart.vue'\nwx.createComponent(Component)"],"names":[],"mappings":";;AAqEA,MAAK,YAAU;AAAA,EACb,MAAM;AAAA,EACN,OAAO;AAAA,IACL,MAAM;AAAA,MACJ,MAAM;AAAA,MACN,UAAU;AAAA,IACZ;AAAA,EACD;AAAA,EAED,OAAO;AACL,WAAO;AAAA,MACL,QAAQ,CAAC,WAAW,WAAW,WAAW,SAAS;AAAA,IACrD;AAAA,EACD;AAAA,EAED,SAAS;AAAA;AAAA,IAEP,YAAY,OAAO;AACjB,UAAI,WAAW;AACf,eAAQ,IAAI,GAAG,IAAI,OAAO,KAAK;AAC7B,oBAAY,KAAK,KAAK,MAAM,CAAC,EAAE;AAAA,MACjC;AACA,aAAO,WAAW;AAAA,IACnB;AAAA;AAAA,IAGD,gBAAgB;AACd,aAAO,KAAK,KAAK,MAAM,OAAO,CAAC,KAAK,SAAS,MAAM,KAAK,OAAO,CAAC;AAAA,IACjE;AAAA;AAAA,IAGD,kBAAkB,MAAM;;AACtB,YAAM,UAAQ,UAAK,KAAK,aAAV,mBAAqB,UAAS;AAC5C,aAAO,KAAK,IAAI,QAAQ,GAAG,EAAE;AAAA,IAC9B;AAAA;AAAA,IAGD,iBAAiB,MAAM;;AACrB,YAAM,UAAQ,UAAK,KAAK,aAAV,mBAAqB,UAAS;AAC5C,UAAG,QAAQ;AAAI,eAAO;AACtB,UAAG,QAAQ;AAAI,eAAO;AACtB,aAAO;AAAA,IACR;AAAA;AAAA,IAGD,iBAAiB,MAAM;;AACrB,eAAO,UAAK,KAAK,aAAV,mBAAqB,UAAS;AAAA,IACtC;AAAA;AAAA,IAGD,cAAc;AACZ,UAAG,CAAC,KAAK,KAAK;AAAU,eAAO;AAE/B,UAAI,WAAW;AACf,UAAI,YAAY;AAEhB,eAAQ,OAAO,GAAG,OAAO,IAAI,QAAQ;AACnC,cAAM,QAAQ,KAAK,KAAK,SAAS,IAAI,KAAK;AAC1C,YAAG,QAAQ,WAAW;AACpB,sBAAY;AACZ,qBAAW;AAAA,QACb;AAAA,MACF;AAEA,aAAO,GAAG,SAAS,SAAU,EAAC,SAAS,GAAG,GAAG,CAAC;AAAA,IAChD;AAAA,EACF;AACF;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;ACvIA,GAAG,gBAAgB,SAAS;"}