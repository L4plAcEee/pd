{"version":3,"file":"index.js","sources":["pages/production/index.vue","D:/yx01/UiApp/HBuilderX/plugins/uniapp-cli-vite/uniPage:/cGFnZXNccHJvZHVjdGlvblxpbmRleC52dWU"],"sourcesContent":["<template>\n  <view class=\"production-container\">\n    <!-- 部门选择 -->\n    <view class=\"dept-select\">\n      <text class=\"select-title\">请选择部门</text>\n      <view class=\"dept-options\">\n        <!-- 磨房部门 -->\n        <view \n          class=\"dept-item\"\n          :class=\"{'dept-active': selectedDept === 'MF'}\"\n          @tap=\"selectDept('MF')\"\n        >\n          <image class=\"dept-icon\" src=\"/static/mf.png\" mode=\"aspectFit\"></image>\n          <text class=\"dept-name\">磨房部门</text>\n          <text class=\"dept-desc\">数据流转至品控部审核</text>\n        </view>\n\n        <!-- 其他部门 -->\n        <view \n          class=\"dept-item\"\n          :class=\"{'dept-active': selectedDept === 'OTHER'}\"\n          @tap=\"selectDept('OTHER')\"\n        >\n          <image class=\"dept-icon\" src=\"/static/other.png\" mode=\"aspectFit\"></image>\n          <text class=\"dept-name\">其他部门</text>\n          <text class=\"dept-desc\">数据直接提交管理员审核</text>\n        </view>\n      </view>\n    </view>\n\n    <!-- 表单区域 -->\n    <view class=\"form-content\" v-if=\"selectedDept\">\n      <!-- 产品编号 -->\n      <view class=\"form-item\">\n        <text class=\"label required\">产品编号</text>\n        <input\n          class=\"input\"\n          v-model=\"formData.productCode\"\n          placeholder=\"请输入产品编号\"\n        />\n      </view>\n\n      <!-- 生产数量 -->\n      <view class=\"form-item\">\n        <text class=\"label required\">生产数量</text>\n        <view class=\"stepper\">\n          <text \n            class=\"step-btn\"\n            @tap=\"updateQuantity('minus')\"\n          >-</text>\n          <input\n            class=\"step-input\"\n            type=\"number\"\n            v-model=\"formData.quantity\"\n          />\n          <text \n            class=\"step-btn\"\n            @tap=\"updateQuantity('plus')\"\n          >+</text>\n        </view>\n      </view>\n\n      <!-- 单价 -->\n      <view class=\"form-item\">\n        <text class=\"label required\">单价(元)</text>\n        <input\n          class=\"input price-input\"\n          type=\"digit\"\n          v-model=\"formData.unitPrice\"\n          @input=\"calculateTotal\"\n          placeholder=\"请输入单价\"\n        />\n      </view>\n\n      <!-- 总价 -->\n      <view class=\"form-item\">\n        <text class=\"label\">总价(元)</text>\n        <view class=\"total-price\">\n          <text>¥ {{totalPrice}}</text>\n          <text class=\"price-tip\" v-if=\"formData.unitPrice && formData.quantity\">\n            {{formData.quantity}} × {{formData.unitPrice}}\n          </text>\n        </view>\n      </view>\n\n      <!-- 备注信息 -->\n      <view class=\"form-item\">\n        <text class=\"label\">备注说明</text>\n        <textarea\n          class=\"textarea\"\n          v-model=\"formData.remark\"\n          placeholder=\"请输入备注说明\"\n        />\n      </view>\n    </view>\n\n    <!-- 提交按钮 -->\n    <view class=\"footer\" v-if=\"selectedDept\">\n      <button \n        class=\"submit-btn\"\n        :disabled=\"!isValid || submitting\"\n        @tap=\"handleSubmit\"\n      >\n        提交{{selectedDept === 'MF' ? '(待品控审核)' : '(待管理审核)'}}\n      </button>\n    </view>\n\n    <!-- 提示组件 -->\n    <pd-toast ref=\"toast\" />\n    <pd-loading v-if=\"submitting\" type=\"global\" text=\"提交中...\" />\n  </view>\n</template>\n\n<script>\nimport { ORDER_STATUS } from '@/utils/constants'\nimport PdToast from '@/components/pd-toast/pd-toast'\nimport PdLoading from '@/components/pd-loading/pd-loading'\n\nexport default {\n  components: {\n    PdToast,\n    PdLoading\n  },\n\n  data() {\n    return {\n      selectedDept: '', // MF: 磨房, OTHER: 其他部门\n      formData: {\n        productCode: '',\n        quantity: 1,\n        unitPrice: '',\n        totalPrice: 0,\n        remark: ''\n      },\n      submitting: false\n    }\n  },\n\n  computed: {\n    isValid() {\n      const { productCode, quantity, unitPrice } = this.formData\n      return this.selectedDept && \n             productCode && \n             quantity > 0 && \n             unitPrice && \n             !isNaN(parseFloat(unitPrice))\n    },\n    \n    totalPrice() {\n      if(!this.formData.unitPrice || !this.formData.quantity) return '0.00'\n      const total = this.formData.quantity * parseFloat(this.formData.unitPrice)\n      return total.toFixed(2)\n    }\n  },\n\n  methods: {\n    // 选择部门\n    selectDept(dept) {\n      this.selectedDept = dept\n      this.resetForm()\n    },\n\n    // 更新数量\n    updateQuantity(type) {\n      if(type === 'minus' && this.formData.quantity > 1) {\n        this.formData.quantity--\n      } else if(type === 'plus') {\n        this.formData.quantity++\n      }\n      this.calculateTotal()\n    },\n\n    // 计算总价\n    calculateTotal() {\n      this.formData.totalPrice = this.totalPrice\n    },\n\n    // 提交表单\n    async handleSubmit() {\n      if(!this.isValid || this.submitting) return\n      \n      this.submitting = true\n      try {\n        const orderData = {\n          ...this.formData,\n          deptCode: this.selectedDept,\n          // 磨房部门提交到品控审核，其他部门直接到管理员审核\n          status: this.selectedDept === 'MF' ? \n            ORDER_STATUS.QC_REVIEW : \n            ORDER_STATUS.PENDING\n        }\n\n        const res = await this.$api.production.submitOrder(orderData)\n\n        if(res.success) {\n          this.$refs.toast.show({\n            type: 'success',\n            message: this.selectedDept === 'MF' ? \n              '提交成功，等待品控审核' : \n              '提交成功，等待管理审核'\n          })\n          this.resetForm()\n        }\n      } catch(e) {\n        this.$refs.toast.show({\n          type: 'error',\n          message: '提交失败'\n        })\n      } finally {\n        this.submitting = false\n      }\n    },\n\n    // 重置表单\n    resetForm() {\n      this.formData = {\n        productCode: '',\n        quantity: 1,\n        unitPrice: '',\n        totalPrice: 0,\n        remark: ''\n      }\n    }\n  }\n}\n</script>\n\n<style>\n/* 页面容器 */\n.production-container {\n  min-height: 100vh;\n  background: #f5f5f5;\n  padding-bottom: 120rpx;\n}\n\n/* 部门标识区 */\n.dept-header {\n  padding: 40rpx 30rpx;\n  display: flex;\n  justify-content: space-between;\n  align-items: center;\n}\n\n.dept-info {\n  color: #fff;\n}\n\n.dept-name {\n  font-size: 40rpx;\n  font-weight: bold;\n  margin-bottom: 8rpx;\n  display: block;\n}\n\n.dept-code {\n  font-size: 28rpx;\n  opacity: 0.8;\n}\n\n.progress-circle {\n  width: 120rpx;\n  height: 120rpx;\n  background: rgba(255,255,255,0.2);\n  border-radius: 50%;\n  display: flex;\n  flex-direction: column;\n  align-items: center;\n  justify-content: center;\n}\n\n.progress-text {\n  color: #fff;\n  font-size: 32rpx;\n  font-weight: bold;\n}\n\n.progress-label {\n  color: #fff;\n  font-size: 24rpx;\n  opacity: 0.8;\n}\n\n/* 表单区域 */\n.form-content {\n  background: #fff;\n  border-radius: 12rpx;\n  margin: 20rpx;\n  padding: 30rpx;\n}\n\n.form-item {\n  margin-bottom: 30rpx;\n}\n\n.label {\n  font-size: 28rpx;\n  color: #333;\n  margin-bottom: 12rpx;\n  display: block;\n}\n\n.required::before {\n  content: '*';\n  color: #ff4d4f;\n  margin-right: 4rpx;\n}\n\n.input {\n  width: 100%;\n  height: 80rpx;\n  background: #f8f8f8;\n  border-radius: 8rpx;\n  padding: 0 20rpx;\n  font-size: 28rpx;\n}\n\n/* 数量步进器 */\n.stepper {\n  display: flex;\n  align-items: center;\n  width: 240rpx;\n}\n\n.step-btn {\n  width: 60rpx;\n  height: 60rpx;\n  background: #f8f8f8;\n  border-radius: 8rpx;\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  font-size: 32rpx;\n}\n\n.step-input {\n  flex: 1;\n  height: 60rpx;\n  background: #f8f8f8;\n  margin: 0 20rpx;\n  text-align: center;\n  font-size: 28rpx;\n}\n\n/* 备注文本框 */\n.textarea {\n  width: 100%;\n  height: 160rpx;\n  background: #f8f8f8;\n  border-radius: 8rpx;\n  padding: 20rpx;\n  font-size: 28rpx;\n}\n\n/* 底部提交 */\n.footer {\n  position: fixed;\n  left: 0;\n  right: 0;\n  bottom: 0;\n  background: #fff;\n  padding: 20rpx;\n  box-shadow: 0 -2rpx 10rpx rgba(0,0,0,0.05);\n}\n\n.submit-btn {\n  width: 100%;\n  height: 80rpx;\n  line-height: 80rpx;\n  background: #1890ff;\n  color: #fff;\n  font-size: 32rpx;\n  border-radius: 40rpx;\n  margin: 0;\n}\n\n.submit-btn[disabled] {\n  opacity: 0.5;\n}\n\n/* 价格输入框 */\n.price-input {\n  width: 300rpx;\n}\n\n/* 总价展示 */\n.total-price {\n  background: #f8f8f8;\n  padding: 20rpx;\n  border-radius: 8rpx;\n  font-size: 32rpx;\n  color: #ff4d4f;\n  font-weight: bold;\n}\n\n.price-tip {\n  font-size: 24rpx;\n  color: #999;\n  margin-left: 20rpx;\n  font-weight: normal;\n}\n\n/* 部门选择样式 */\n.dept-select {\n  padding: 30rpx;\n}\n\n.select-title {\n  font-size: 32rpx;\n  color: #333;\n  margin-bottom: 30rpx;\n  display: block;\n}\n\n.dept-options {\n  display: flex;\n  flex-direction: column;\n  gap: 20rpx;\n}\n\n.dept-item {\n  background: #fff;\n  border-radius: 12rpx;\n  padding: 30rpx;\n  display: flex;\n  align-items: center;\n  gap: 20rpx;\n  transition: all 0.3s;\n}\n\n.dept-active {\n  background: #e6f7ff;\n  border: 2rpx solid #1890ff;\n}\n\n.dept-icon {\n  width: 80rpx;\n  height: 80rpx;\n}\n\n.dept-name {\n  font-size: 32rpx;\n  color: #333;\n  font-weight: bold;\n}\n\n.dept-desc {\n  font-size: 24rpx;\n  color: #666;\n  margin-left: auto;\n}\n\n/* 表单区域在选择部门后显示 */\n.form-content {\n  margin-top: 30rpx;\n  background: #fff;\n  border-radius: 12rpx;\n  padding: 30rpx;\n}\n</style> ","import MiniProgramPage from 'C:/Users/18454/OneDrive/文档/GitHub/pd/pd071/pages/production/index.vue'\nwx.createPage(MiniProgramPage)"],"names":["ORDER_STATUS"],"mappings":";;;;AAmHA,gBAAgB,MAAW;AAC3B,MAAK,YAAa,MAAW;AAE7B,MAAK,YAAU;AAAA,EACb,YAAY;AAAA,IACV;AAAA,IACA;AAAA,EACD;AAAA,EAED,OAAO;AACL,WAAO;AAAA,MACL,cAAc;AAAA;AAAA,MACd,UAAU;AAAA,QACR,aAAa;AAAA,QACb,UAAU;AAAA,QACV,WAAW;AAAA,QACX,YAAY;AAAA,QACZ,QAAQ;AAAA,MACT;AAAA,MACD,YAAY;AAAA,IACd;AAAA,EACD;AAAA,EAED,UAAU;AAAA,IACR,UAAU;AACR,YAAM,EAAE,aAAa,UAAU,UAAY,IAAE,KAAK;AAClD,aAAO,KAAK,gBACL,eACA,WAAW,KACX,aACA,CAAC,MAAM,WAAW,SAAS,CAAC;AAAA,IACpC;AAAA,IAED,aAAa;AACX,UAAG,CAAC,KAAK,SAAS,aAAa,CAAC,KAAK,SAAS;AAAU,eAAO;AAC/D,YAAM,QAAQ,KAAK,SAAS,WAAW,WAAW,KAAK,SAAS,SAAS;AACzE,aAAO,MAAM,QAAQ,CAAC;AAAA,IACxB;AAAA,EACD;AAAA,EAED,SAAS;AAAA;AAAA,IAEP,WAAW,MAAM;AACf,WAAK,eAAe;AACpB,WAAK,UAAU;AAAA,IAChB;AAAA;AAAA,IAGD,eAAe,MAAM;AACnB,UAAG,SAAS,WAAW,KAAK,SAAS,WAAW,GAAG;AACjD,aAAK,SAAS;AAAA,iBACN,SAAS,QAAQ;AACzB,aAAK,SAAS;AAAA,MAChB;AACA,WAAK,eAAe;AAAA,IACrB;AAAA;AAAA,IAGD,iBAAiB;AACf,WAAK,SAAS,aAAa,KAAK;AAAA,IACjC;AAAA;AAAA,IAGD,MAAM,eAAe;AACnB,UAAG,CAAC,KAAK,WAAW,KAAK;AAAY;AAErC,WAAK,aAAa;AAClB,UAAI;AACF,cAAM,YAAY;AAAA,UAChB,GAAG,KAAK;AAAA,UACR,UAAU,KAAK;AAAA;AAAA,UAEf,QAAQ,KAAK,iBAAiB,OAC5BA,gBAAAA,aAAa,YACbA,gBAAAA,aAAa;AAAA,QACjB;AAEA,cAAM,MAAM,MAAM,KAAK,KAAK,WAAW,YAAY,SAAS;AAE5D,YAAG,IAAI,SAAS;AACd,eAAK,MAAM,MAAM,KAAK;AAAA,YACpB,MAAM;AAAA,YACN,SAAS,KAAK,iBAAiB,OAC7B,gBACA;AAAA,WACH;AACD,eAAK,UAAU;AAAA,QACjB;AAAA,MACF,SAAQ,GAAG;AACT,aAAK,MAAM,MAAM,KAAK;AAAA,UACpB,MAAM;AAAA,UACN,SAAS;AAAA,SACV;AAAA,MACH,UAAU;AACR,aAAK,aAAa;AAAA,MACpB;AAAA,IACD;AAAA;AAAA,IAGD,YAAY;AACV,WAAK,WAAW;AAAA,QACd,aAAa;AAAA,QACb,UAAU;AAAA,QACV,WAAW;AAAA,QACX,YAAY;AAAA,QACZ,QAAQ;AAAA,MACV;AAAA,IACF;AAAA,EACF;AACF;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AC/NA,GAAG,WAAW,eAAe;"}